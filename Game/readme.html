<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="" />
  <title>103 Project 3: Game of Life</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  
  <style type="text/css">
  body 
  {
  	font-family:Gill Sans MT;
  	color:#657b83;
  	background-color:#fdf6e3;
  	max-width:500pt;
  	padding-left:25pt;
  	padding-right:25pt;
  	padding-bottom:20pt;
  	margin:0 auto 0 auto;
  	text-align:justify;
  }
  a:link {color:#6c71c4;}
  a:visited {color:#859900;}
  a:hover {color:#268bd2;}
  a:active {color:#d33682;}
  h1{}
  h2{border-style:solid;
   text-align:center;
  }
  h3
  {
  	margin-bottom:2pt;
  	/*color:#268bd2;*/
  	font-weight:bold;
  }
  strong
  {
  	color:#d33682;
  	font-weight:bolder;
  }
  em
  {
  	color:#268bd2;
  	font-style:italic;
  	font-weight:bolder;
  }
  code
  {
      background-color:#eee8d5;
      color:#586e75;
  }
  table.sourceCode
  {
      background-color:#eee8d5;
      color:#586e75;
  }
  pre.sourceCode
  {
      background-color:#eee8d5;
      color:#586e75;
  }
  .math
  {
      /*background-color:#eee8d5;*/
      color:#586e75;
      font-family:Times New Roman;
  }
  /*use a contextual style to undo the blue-ness:*/
  .math em
  {
      color:#586e75;
  	font-weight:normal;
  }
  .descrip
  {
  	max-width:500pt;
  	padding-left:25pt;
  	text-align:justify;
  }
  .descripbig
  {
  	max-width:575pt;
  	padding-left:0pt;
  	text-align:justify;
  }
  .emph
  {
  	color:#d33682;
  	font-weight:bolder;
  }
  .litem
  {
  	color:#268bd2;
  	font-style:italic;
  	font-weight:bolder;
  }
  .hl
  {
  	color:#268bd2;
  	font-style:italic;
  }
  .required
  {
  	color:#268bd2;
  	font-style:italic;
  	font-weight:bold;
  }
  .inputbox
  {
  	background-color:#eee8d5;
  	color:#586e75;
  	font-family:Gill Sans MT;
  	font-weight:bolder;
  }
  </style>
</head>
<body>
<div id="header">
<h1 class="title">103 Project 3: Game of Life</h1>
<h2 class="author"></h2>
</div>
<h2 id="due-friday-march-10th-1159pm"><em>Due:</em> Friday, March 10th @ 11:59pm</h2>
<!---{{ Synopsis-->
<h2 id="synopsis">Synopsis</h2>
<p>In this project, you are going to implement <a href="https://en.wikipedia.org/wiki/Conway%27s_game_of_life">Conway’s Game of Life</a>. There are quite some interesting things to say about the Game of Life, but for our purposes, we just care that it makes pretty pictures.</p>
<p>What you’ll learn from doing this:</p>
<ul>
<li>More about the <code>&lt;vector&gt;</code> class.</li>
<li>Reading and writing files.</li>
<li>Command line arguments and <code>getopt_long</code>.</li>
<li>Functions and arguments.</li>
<li>A bit more about the unix shell.</li>
</ul>
<h2 id="important-notes-on-grading">Important Notes on Grading</h2>
<p>Unlike prior assignments, you’ll do this one collaboratively. Teams <strong>must be 3 – 4 people</strong>, and <strong>your teammates must be in the same recitation</strong>. Details:</p>
<ul>
<li>Everyone should sign up on <a href="https://bitbucket.org/">bitbucket</a>.</li>
<li>Designate one member of your team to be the leader / repository owner. (They’ll set up the repository and grant access to the rest of the team.)</li>
<li>Commits from the team members can be incorporated in one of two ways:
<ol style="list-style-type: decimal">
<li>Follow the instructions on <a href="http://www-cs.ccny.cuny.edu/~wes/CSC103S17/scm.html#collaborate">collaborating with git</a>. (Team leaders: don’t forget to give other members write access to the repository.)</li>
<li>Use <a href="https://www.atlassian.com/git/tutorials/making-a-pull-request/example">bitbucket’s fork + pull request</a> features.</li>
</ol>
<strong>NOTE:</strong> Either way you do it, you should follow the guidelines given above about <a href="http://www-cs.ccny.cuny.edu/~wes/CSC103S17/scm.html#collaborate">avoiding merge conflicts</a>.</li>
<li>Team leaders – please <em>edit</em> (or start, if it doesn’t exist) a piazza post containing the url of your repository, and a list of the team’s members. Please make different posts for each section (MM,MM2,MM3).</li>
<li>Your projects will be graded based on whether or not they pass the automated tests, and whether or not each team member is contributing (as evidenced by the commit logs).</li>
</ul>
<!---}}-->
<!---{{ Details-->
<h2 id="details">Details</h2>
<p>In case you didn’t bother to read the Wikipedia article, the Game of Life is a cellular automaton. That is, it’s a grid of cells which are all in one of two states (“alive” or “dead”). The grid is then transformed at regular intervals with each cell’s state being updated according to the following simple set of rules:</p>
<ol style="list-style-type: decimal">
<li>If a live cell has fewer than 2 neighbors, it dies (underpopulation).</li>
<li>If a live cell has more than 3 neighbors, it dies (overpopulation).</li>
<li>If a dead cell has exactly 3 neighbors, it becomes alive (reproduction).</li>
</ol>
<p>Note also that the grid is finite, but to avoid having any walls or boundaries, we’ll glue opposite edges together to form a <a href="https://en.wikipedia.org/wiki/Torus">torus</a>, kind of like some of those <a href="https://en.wikipedia.org/wiki/Wraparound_(video_games)">old school video games</a>. So, each cell will have <strong>exactly 8 neighbors</strong>.</p>
<h3 id="command-line-interface">Command line interface</h3>
<p>Part of this assignment’s purpose is to teach you about writing programs that accept arguments on the command line. I’ve given you a skeleton that works most of this stuff out for you (using GNU’s venerable <code>getopt_long</code> function). In particular, we will have the following options, which can be shown by running <code>./life --help</code>:</p>
<div class="sourceCode"><pre class="sourceCode latex"><code class="sourceCode latex">Usage: ./life [OPTIONS]...
Text-based version of Conway&#39;s game of life.

   --seed,-s     FILE     read start state from FILE.
   --world,-w    FILE     store current world in FILE.
   --fast-fw,-f  NUM      evolve system for NUM generations and quit.
   --help,-h              show this message and exit.</code></pre></div>
<p>The <code>-s</code> option is for the initial state of the “world”. You can see examples in the <code>res/</code> directory for the format. Dead cells are represented by <code>.</code> characters and live ones by <code>O</code>. You can infer the grid size from the length of the first line, and the total number of lines you’ve read.</p>
<p>There are two kinds of <em>modes</em> for your program. The first mode slowly evolves the initial configuration once every second, writing the output to whatever file was supplied with <code>-w</code>. You can then watch the system evolve by watching the output file with the <code>watch</code> command. It’ll look something like this:</p>
<center>
<div class="figure">
<img src="gol.gif" alt="A few early generations of the R-pentomino." />
<p class="caption">A few early generations of the R-pentomino.</p>
</div>
</center>
<p>The second mode will evolve the system as fast as it can for some specified number of generations, specified by <code>-f</code>. <strong>Important:</strong> if the user supplies <code>-f</code>, you should not do any waiting! Compute the desired generation, write the output, and quit.</p>
<h3 id="standard-input-and-output">Standard input and output</h3>
<p>You can also use this program as a <em>filter</em> that reads standard input and writes standard output (like most unix utilities). We’ll use the following (fairly common) convention: the special argument <code>-</code> will be used to denote standard input for files to be read, and standard output for files to be written. So, there’s kind of a third “filter mode” for your program, where you run it with arguments <code>./life -s - -w - -f 1</code> (interpretation: <code>-s -</code> means read from <code>stdin</code>, <code>-w -</code> means write to <code>stdout</code>, and <code>-f 1</code> means evolve system for just one generation and quit). Here’s a quick example that would evolve a glider 3 generations:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">./life</span> -f 1 -s res/glider-40x20 -w - \
   <span class="kw">|</span> <span class="kw">./life</span> -f 1 -s - -w - <span class="kw">|</span> <span class="kw">./life</span> -f 1 -s - -w -
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">..................O.....................</span>
<span class="kw">...................OO...................</span>
<span class="kw">..................OO....................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span>
<span class="kw">........................................</span></code></pre></div>
<p>Of course, we could have done this in a much more straightforward way with <code>./life -f 3 -s res/glider-40x20 -w -</code> (note the <code>-f 3</code>), but the above command pipeline was to illustrate the “filter” usage of the program. Probably not super useful in such a specialized setting, but I do want you to get used to the idea, and have some practice in writing these types of programs.</p>
<!---}}-->
<!---{{ Testing-->
<h2 id="running-testing-your-code">Running + Testing Your Code</h2>
<p>You can check a few of the examples given above to see if your output seems to match. You can also (carefully!) follow the rules by hand for a simple configuration and make sure your program is doing what you expect. If you just want to watch the excitement unfold, you can run <code>./life</code> in one terminal, and in another, <code>watch -n 1 &quot;cat /tmp/gol-world-current&quot;</code>. The <code>watch</code> command just reads the contents of <code>/tmp/gol-world-current</code> once a second and dumps the result to the screen. If things are working, pretty pictures should happen. You can kill the program with <code>ctrl-c</code> (this works for your program, and for <code>watch</code>). And if for some reason you object to having multiple terminals open, try this:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">./life</span> -s res/acorn-110x60 <span class="kw">&amp;</span> <span class="co"># &lt;-- don&#39;t forget the &amp; at the end.</span>
$ <span class="kw">watch</span> -n 1 <span class="st">&quot;cat /tmp/gol-world-current&quot;</span></code></pre></div>
<p>And then to stop your program, run <code>pkill -x life</code> once you’ve stopped <code>watch</code> with <code>ctrl-c</code>.</p>
<p>There are also some automated tests. You can run this with <code>./test.sh</code>. In the <code>tests/</code> directory, there are files corresponding to the evolution of a glider. The script just makes sure your program does the same thing, and lets you know if/when there is ever a difference.</p>
<!---}}-->
<!---{{ Remarks-->
<h2 id="remarks">Remarks</h2>
<p>The “right” way to write a program like this (which frequently updates portions of an entire terminal) is probably to use the <a href="https://en.wikipedia.org/wiki/Ncurses">ncurses</a> library. So why aren’t we doing it that way? Mainly because <a href="https://en.wikipedia.org/wiki/Ncurses">ncurses</a> can be difficult to debug and introduces more complications and distractions than would be worth what is gained. Hence we let the <code>watch</code> program do the curses stuff for us instead.</p>
<!---}}-->
<!---{{ Hints-->
<h2 id="hints">Hints</h2>
<h3 id="vectors">Vectors</h3>
<p>I’d like you to use <a href="http://www.cplusplus.com/reference/vector/vector/">vector</a> objects to store the cells. This is pretty straightforward, but there is one syntax nuisance, which is that you must separate the last <code>&gt;</code> by a space<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>, like this in the declaration:</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp">vector&lt;vector&lt;<span class="dt">bool</span>&gt; &gt; W;
<span class="co">//                 ^ this space is important -_-</span></code></pre></div>
<p>You can then access the <code>(i,j)</code> element of the structure as you would expect:</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp">W[i][j] = <span class="kw">false</span>; <span class="co">// set the cell in the ith row and jth column to false.</span></code></pre></div>
<p>By the way, you will probably want to use <em>two</em> such vectors. One for the old state, and one for the new state (doing this in place is would be a little tricky, as you want to transform the entire board at once, rather than piece by piece).</p>
<h3 id="reading-files">Reading files</h3>
<p>There are several ways. One way is to use <a href="http://www.cplusplus.com/reference/fstream/fstream/">file streams</a>, which work more or less like <code>cin</code> and <code>cout</code>, but they can write to files other than <code>stdin</code> and <code>stdout</code>. However, I’ve had frustrations regarding the lack of transparency with these so I would instead use the old C-style methods which are described below. If you really want to use the C++ mechanisms, maybe read the tutorials <a href="https://en.wikibooks.org/wiki/C%2B%2B_Programming/Code/IO#fstream">here</a> or <a href="http://www.cplusplus.com/doc/tutorial/files/">here</a>.</p>
<p>How to open and read a file:</p>
<div class="sourceCode"><table class="sourceCode cpp numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="sourceCode"><pre><code class="sourceCode cpp"><span class="co">/* Open the file (for reading), storing the handle in f: */</span>
FILE* f = fopen(<span class="st">&quot;/path/to/myfile&quot;</span>,<span class="st">&quot;rb&quot;</span>);
<span class="co">/* make sure file was opened properly: */</span>
<span class="kw">if</span> (!f) {
    <span class="co">// deal with error by printing a message, or maybe quitting</span>
    <span class="co">// the entire program with a non-zero exit code, like this:</span>
    exit(<span class="dv">1</span>);
}
<span class="co">/* Read a single character from the file: */</span>
<span class="dt">char</span> c; <span class="co">// storage for the byte we&#39;ll read</span>
fread(&amp;c,<span class="dv">1</span>,<span class="dv">1</span>,f); <span class="co">// read one byte, place it in c</span>
<span class="co">/* when you&#39;re done with the file, be sure to close it like this: */</span>
fclose(f);</code></pre></td></tr></table></div>
<p>You can tell when you hit the end of file by looking at the return value from <code>fread</code> – it will be 0.<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<p>How to open and write a file:</p>
<div class="sourceCode"><table class="sourceCode cpp numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
</pre></td><td class="sourceCode"><pre><code class="sourceCode cpp"><span class="co">/* Open the file (for writing), storing the handle in f: */</span>
FILE* f = fopen(<span class="st">&quot;/path/to/myfile&quot;</span>,<span class="st">&quot;wb&quot;</span>);
<span class="co">/* Write a single character to the file: */</span>
<span class="dt">char</span> c = <span class="st">&#39;.&#39;</span>;
fwrite(&amp;c,<span class="dv">1</span>,<span class="dv">1</span>,f); <span class="co">// write a byte to f</span>
<span class="co">/* close f when done: */</span>
fclose(f);</code></pre></td></tr></table></div>
<p><em>NOTE:</em> for the output file, you may want to keep the same <code>FILE* f</code> open, and keep on re-writing it (without an <code>fclose</code> and <code>fopen</code> each time). For this, you have to move back to the beginning of the file. Fortunately, this is as easy as:</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp">rewind(f);</code></pre></div>
<p>The next write will be to the first byte of the file.</p>
<p>I have also made defaults for the input and output files. Furthermore, I made them both the same, so that if you run the program without arguments, it will just pick up where it left off.</p>
<h4 id="stdin-and-stdout">stdin and stdout</h4>
<p>There are built-in <code>FILE*</code> variables that correspond to standard input and standard output. They are named <code>stdin</code> and <code>stdout</code>, respectively. So, if someone passes a filename of <code>&quot;-&quot;</code>, then you can just use <code>stdin</code> (<code>stdout</code>) as the <code>FILE*</code> that you read from (write to), rather than opening a file with <code>fopen</code>.</p>
<h3 id="how-to-sleep-_">How to Sleep =_=</h3>
<p>Sometimes it is nice to suspend the execution of your program for an interval of time. Rather than writing a “busy loop” that just wastes resources, the right way to do this is to suspend the execution of your program, which can be done with some help from the operating system. The <code>sleep</code> function (found in <code>&lt;unistd.h&gt;</code>) can be used like this:</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp">sleep(<span class="dv">1</span>); <span class="co">// sleep for 1 second</span></code></pre></div>
<h3 id="suggested-functions">Suggested functions</h3>
<p>I might also recommend you organize your work into a number of functions. I’ve given some prototypes in source file that you can implement if you want, but if you think you have a better way, go for it! Talking out strategies with your teammates can be very educational! Anyway, here’s what I used:</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="co">// count neighbors of cell i,j on grid g:</span>
size_t nbrCount(size_t i, size_t j, <span class="dt">const</span> vector&lt;vector&lt;<span class="dt">bool</span>&gt; &gt;&amp; g);
<span class="dt">void</span> update(); <span class="co">// transform the old version of the world into the new one</span>
<span class="dt">int</span> initFromFile(<span class="dt">const</span> string&amp; fname); <span class="co">// read initial state from file</span>
<span class="dt">void</span> dumpState(FILE* f); <span class="co">// write the state to a file</span>
<span class="dt">void</span> mainLoop(); <span class="co">// update state, write state, sleep, repeat...</span></code></pre></div>
<h3 id="getopt_long">getopt_long</h3>
<p>This is the standard way (on Linux) to process command line arguments. Don’t worry too much about how it works right now. The stuff I’ve left in the skeleton will parse the options, and place them in global variables. In particular, the variables <code>max_gen,wfilename,initfilename</code> will be set for you. Their meaning should be clear from the comments:</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp">size_t max_gen = <span class="dv">0</span>; <span class="co">/* if &gt; 0, fast forward to this generation. */</span>
string wfilename =  <span class="st">&quot;/tmp/gol-world-current&quot;</span>; <span class="co">/* write state here */</span>
string initfilename = <span class="st">&quot;/tmp/gol-world-current&quot;</span>; <span class="co">/* read initial state from here. */</span></code></pre></div>
<h3 id="makefiles">Makefiles</h3>
<p>I again gave you a simplistic makefile for your convenience. Using the tutorials (<a href="http://frank.mtsu.edu/~csdept/FacilitiesAndResources/make.htm">here</a> and <a href="http://www.cs.umd.edu/class/fall2002/cmsc214/Tutorial/makefile.html">here</a>), try to reverse engineer it if you have time.</p>
<!---}}-->
<!---{{ Submission Procedure-->
<h2 id="submission-procedure">Submission Procedure</h2>
<p>Your assignment will be graded by the TAs soon after the deadline, possibly during recitation (so you should be prepared to explain what you wrote!). For full credit, your project should</p>
<ol style="list-style-type: decimal">
<li>Pass any automated tests;</li>
<li>Be hosted on bitbucket;</li>
<li>Have non-trivial contributions from each team member (this should be reflected in the commit logs).</li>
</ol>
<!---}}-->
<!---{{ links-->
<!---}}-->
<!---
% vim:ff=unix:textwidth=78:foldmethod=marker:foldmarker={{,}}
-->
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>This has been rectified in recent standards of the language.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>This is a bit of an oversimplification, but don’t worry about that for now. It is pretty safe to assume that <code>fread</code> returning 0 means you ran out of file if you use it as in the example. See <code>man fread</code> if you want to learn more.<a href="#fnref2">↩</a></p></li>
</ol>
</div>
</body>
</html>
